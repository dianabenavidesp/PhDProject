library(ggplot2)
library("cowplot")

# #Accuracy no stdev
# accuracy<-data.frame(dataset = character(), method = character(), numberiters = integer(), accuracy = double())
# #Caltech256
# accuracy<-c("Caltech256","NT0", 10, 89.8763)
# accuracy<-rbind(accuracy,c("Caltech256", "NT0", 25, 90.2570))
# accuracy<-rbind(accuracy,c("Caltech256", "NT0", 50, 90.9575))
# accuracy<-rbind(accuracy,c("Caltech256", "NT0", 100, 89.8809))
# accuracy<-rbind(accuracy,c("Caltech256","NT1", 10, 72.0859))
# accuracy<-rbind(accuracy,c("Caltech256", "NT1", 25, 72.0859))
# accuracy<-rbind(accuracy,c("Caltech256", "NT1", 50, 74.0846))
# accuracy<-rbind(accuracy,c("Caltech256", "NT1", 100, 73.0846))
# accuracy<-rbind(accuracy,c("Caltech256", "NT2", 10, 79.8763))
# accuracy<-rbind(accuracy,c("Caltech256", "NT2", 25, 80.2570))
# accuracy<-rbind(accuracy,c("Caltech256", "NT2", 50, 80.9575))
# accuracy<-rbind(accuracy,c("Caltech256", "NT2", 100, 79.8809))
# accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 10, 91.0081))
# accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 25, 91.1330))
# accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 50, 91.5245))
# accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 100, 90.9885))
# accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 10, 83.0))
# accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 25, 83.0))
# accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 50, 83.0))
# accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 100, 83.0))
# accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 10, 91.3232))
# accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 25, 91.7209))
# accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 50, 92.5843))
# accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 100, 93.1105))
# #ImageNet
# accuracy<-rbind(accuracy,c("ImageNet","NT0", 10, 79.2553))
# accuracy<-rbind(accuracy,c("ImageNet", "NT0", 25, 79.2553))
# accuracy<-rbind(accuracy,c("ImageNet", "NT0", 50, 79.2553))
# accuracy<-rbind(accuracy,c("ImageNet", "NT0", 100, 79.2553))
# accuracy<-rbind(accuracy,c("ImageNet","NT1", 10, 72.0593))
# accuracy<-rbind(accuracy,c("ImageNet", "NT1", 25, 72.56786))
# accuracy<-rbind(accuracy,c("ImageNet", "NT1", 50, 72.0593))
# accuracy<-rbind(accuracy,c("ImageNet", "NT1", 100, 72.56786))
# accuracy<-rbind(accuracy,c("ImageNet", "NT2", 10, 76.2553))
# accuracy<-rbind(accuracy,c("ImageNet", "NT2", 25, 76.2553))
# accuracy<-rbind(accuracy,c("ImageNet", "NT2", 50, 77.0553))
# accuracy<-rbind(accuracy,c("ImageNet", "NT2", 100, 76.2553))
# accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 10, 80.6827))
# accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 25, 80.6027))
# accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 50, 80.4526))
# accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 100, 80.6827))
# accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 10, 85.0))
# accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 25, 85.0))
# accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 50, 85.0))
# accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 100, 85.0))
# accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 10, 82.4445))
# accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 25, 82.8409))
# accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 50, 83.6369))
# accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 100, 83.9369))
# #Office
# accuracy<-rbind(accuracy,c("Office","NT0", 10, 85.9871))
# accuracy<-rbind(accuracy,c("Office", "NT0", 25, 87.2244))
# accuracy<-rbind(accuracy,c("Office", "NT0", 50, 87.2244))
# accuracy<-rbind(accuracy,c("Office", "NT0", 100, 87.0201))
# accuracy<-rbind(accuracy,c("Office","NT1", 10, 71.4013))
# accuracy<-rbind(accuracy,c("Office", "NT1", 25, 71.4013))
# accuracy<-rbind(accuracy,c("Office", "NT1", 50, 73.7896))
# accuracy<-rbind(accuracy,c("Office", "NT1", 100, 72.9896))
# accuracy<-rbind(accuracy,c("Office", "NT2", 10, 75.9871))
# accuracy<-rbind(accuracy,c("Office", "NT2", 25, 77.2244))
# accuracy<-rbind(accuracy,c("Office", "NT2", 50, 77.2244))
# accuracy<-rbind(accuracy,c("Office", "NT2", 100, 77.0201))
# accuracy<-rbind(accuracy,c("Office", "ASVM", 10, 86.777))
# accuracy<-rbind(accuracy,c("Office", "ASVM", 25, 86.2244))
# accuracy<-rbind(accuracy,c("Office", "ASVM", 50, 86.2244))
# accuracy<-rbind(accuracy,c("Office", "ASVM", 100, 87.0201))
# accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 10, 84.93901963))
# accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 25, 85.00039066))
# accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 50, 85.33356154))
# accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 100, 85.6620546))
# rownames(accuracy)<-NULL
# accuracy<-as.data.frame(accuracy)
# colnames(accuracy)<-c("dataset", "method", "sources", "accur")
# accuracy$accur<-as.double(as.character(accuracy$accur))
# accuracy$sources <- factor(accuracy$sources, levels = c("10", "25", "50", "100"))
# 
# plotAccuracy <- ggplot(accuracy, aes(x = sources, y = accur, group = method, shape = method, colour = method )) + 
#   geom_line() + geom_point() + facet_grid(. ~ dataset) + xlab("number of sources (%)") + ylab("prediction accuracy (%)") + theme(legend.title=element_blank()) + 
#   panel_border() + theme(text=element_text(family="serif")) + ylim(50, 100) 
# plotAccuracy <- plotAccuracy + scale_colour_grey()
# plotAccuracy

#Accuracy
accuracy<-data.frame(dataset = character(), method = character(), numberiters = integer(), accuracy = double(), std = double())
#Office
accuracy<-rbind(accuracy,c("Office","TH", 10, 85.9871, 1.571241676))
accuracy<-rbind(accuracy,c("Office", "TH", 25, 87.2244, 1.503534803))
accuracy<-rbind(accuracy,c("Office", "TH", 50, 87.2244, 1.503534803))
accuracy<-rbind(accuracy,c("Office", "TH", 100, 87.0201, 1.640615181))
accuracy<-rbind(accuracy,c("Office","SH", 10, 71.4013, 7.1883))
accuracy<-rbind(accuracy,c("Office", "SH", 25, 71.4013, 4.1705))
accuracy<-rbind(accuracy,c("Office", "SH", 50, 73.7896, 4.1705))
accuracy<-rbind(accuracy,c("Office", "SH", 100, 72.9896, 7.1883))
accuracy<-rbind(accuracy,c("Office", "S+TH", 10, 75.9871, 7.571241676))
accuracy<-rbind(accuracy,c("Office", "S+TH", 25, 77.2244, 4.503534803))
accuracy<-rbind(accuracy,c("Office", "S+TH", 50, 77.2244, 4.503534803))
accuracy<-rbind(accuracy,c("Office", "S+TH", 100, 77.0201, 6.640615181))
accuracy<-rbind(accuracy,c("Office", "ASVM", 10, 86.777, 2.3341676))
accuracy<-rbind(accuracy,c("Office", "ASVM", 25, 86.2244, 2.7534803))
accuracy<-rbind(accuracy,c("Office", "ASVM", 50, 86.2244, 2.6534803))
accuracy<-rbind(accuracy,c("Office", "ASVM", 100, 87.0201, 2.0985181))
accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 10, 84.93901963, 2.482162672))
accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 25, 85.00039066, 1.618903173))
accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 50, 85.33356154, 2.54389753))
accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 100, 85.66205464, 2.08536056))
#Caltech256
accuracy<-c("Caltech256","TH", 10, 89.8763, 1.3470)
accuracy<-rbind(accuracy,c("Caltech256", "TH", 25, 90.2570, 2.7585))
accuracy<-rbind(accuracy,c("Caltech256", "TH", 50, 90.9575, 1.9458))
accuracy<-rbind(accuracy,c("Caltech256", "TH", 100, 89.8809, 2.2167))
accuracy<-rbind(accuracy,c("Caltech256","SH", 10, 72.0859, 6.4726))
accuracy<-rbind(accuracy,c("Caltech256", "SH", 25, 72.0859, 6.4726))
accuracy<-rbind(accuracy,c("Caltech256", "SH", 50, 74.0846, 7.4477))
accuracy<-rbind(accuracy,c("Caltech256", "SH", 100, 73.0846, 7.4477))
accuracy<-rbind(accuracy,c("Caltech256", "S+TH", 10, 79.8763, 5.374882579))
accuracy<-rbind(accuracy,c("Caltech256", "S+TH", 25, 80.2570, 5.374882579))
accuracy<-rbind(accuracy,c("Caltech256", "S+TH", 50, 80.9575, 5.374882579))
accuracy<-rbind(accuracy,c("Caltech256", "S+TH", 100, 79.8809, 5.374882579))
accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 10, 91.0081, 3.131431345))
accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 25, 91.1330, 2.666461675))
accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 50, 91.5245, 2.707930941))
accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 100, 90.9885, 2.675935695))
accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 10, 0, 0))
accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 25, 0, 0))
accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 50, 0, 0))
accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 100, 0, 0))
accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 10, 91.3232, 1.591015772))
accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 25, 91.7209, 2.05381851))
accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 50, 92.5843, 1.979364632))
accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 100, 93.1105, 1.50563365))
# #ImageNet
accuracy<-rbind(accuracy,c("ImageNet","TH", 10, 79.2553, 5.6270))
accuracy<-rbind(accuracy,c("ImageNet", "TH", 25, 79.2553, 5.6270))
accuracy<-rbind(accuracy,c("ImageNet", "TH", 50, 79.2553, 5.6270))
accuracy<-rbind(accuracy,c("ImageNet", "TH", 100, 79.2553, 5.6270))
accuracy<-rbind(accuracy,c("ImageNet","SH", 10, 72.0593, 5.8922))
accuracy<-rbind(accuracy,c("ImageNet", "SH", 25, 72.56786, 7.48479))
accuracy<-rbind(accuracy,c("ImageNet", "SH", 50, 72.0593, 5.8922))
accuracy<-rbind(accuracy,c("ImageNet", "SH", 100, 72.56786, 7.48479))
accuracy<-rbind(accuracy,c("ImageNet", "S+TH", 10, 76.2553, 6.8922))
accuracy<-rbind(accuracy,c("ImageNet", "S+TH", 25, 76.2553, 6.8922))
accuracy<-rbind(accuracy,c("ImageNet", "S+TH", 50, 77.0553, 7.8922))
accuracy<-rbind(accuracy,c("ImageNet", "S+TH", 100, 76.2553, 7.8922))
accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 10, 80.6827, 6.4305))
accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 25, 80.6027, 6.4305))
accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 50, 80.4526, 6.4305))
accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 100, 80.6827, 6.4305))
accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 10, 0, 0))
accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 25, 0, 0))
accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 50, 0, 0))
accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 100, 0, 0))
accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 10, 82.4445, 5.0766))
accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 25, 82.8409, 5.83404))
accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 50, 83.6369, 5.1569))
accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 100, 83.9369, 5.1569))
rownames(accuracy)<-NULL
accuracy<-as.data.frame(accuracy)
colnames(accuracy)<-c("dataset", "method", "sources", "accur", "stdev")
accuracy$accur<-as.double(as.character(accuracy$accur))
accuracy$stdev<-as.double(as.character(accuracy$stdev))
accuracy$sources <- factor(accuracy$sources, levels = c("10", "25", "50", "100"))
accuracy$dataset <- factor(accuracy$dataset, levels = c("Office", "Caltech256", "ImageNet"))

plotAccuracy <- ggplot(accuracy, aes(x = sources, y = accur, group = method, shape = method, colour = method )) +
  geom_line() + geom_point() + facet_grid(. ~ dataset) + xlab("number of sources (%)") + ylab("prediction accuracy (%)") + theme(legend.title=element_blank()) +
  panel_border() + theme(text=element_text(family="serif") , legend.text = element_text(face="bold", size=12), strip.text.x = element_text(face="bold")) + ylim(50, 100) + geom_errorbar(aes(x=sources, ymin=accur-stdev, ymax=accur+stdev), width=0.25)
plotAccuracy <- plotAccuracy + scale_colour_grey()
plotAccuracy



#Accuracy without error bars
accuracy<-data.frame(dataset = character(), method = character(), numberiters = integer(), accuracy = double(), std = double())
#Office
accuracy<-c("Office","TH", 10, 87.2871, 0)
accuracy<-rbind(accuracy,c("Office", "TH", 25, 87.2244, 0))
accuracy<-rbind(accuracy,c("Office", "TH", 50, 87.2244, 0))
accuracy<-rbind(accuracy,c("Office", "TH", 100, 87.0201, 0))
accuracy<-rbind(accuracy,c("Office","SH", 10, 71.4013, 0))
accuracy<-rbind(accuracy,c("Office", "SH", 25, 71.4013, 0))
accuracy<-rbind(accuracy,c("Office", "SH", 50, 73.7896, 0))
accuracy<-rbind(accuracy,c("Office", "SH", 100, 72.9896, 0))
accuracy<-rbind(accuracy,c("Office", "S+TH", 10, 75.9871, 0))
accuracy<-rbind(accuracy,c("Office", "S+TH", 25, 77.2244, 0))
accuracy<-rbind(accuracy,c("Office", "S+TH", 50, 77.2244, 0))
accuracy<-rbind(accuracy,c("Office", "S+TH", 100, 77.0201, 0))
accuracy<-rbind(accuracy,c("Office", "ASVM", 10, 86.777, 0))
accuracy<-rbind(accuracy,c("Office", "ASVM", 25, 86.2244, 0))
accuracy<-rbind(accuracy,c("Office", "ASVM", 50, 86.2244, 0))
accuracy<-rbind(accuracy,c("Office", "ASVM", 100, 87.0201, 0))
accuracy<-rbind(accuracy,c("Office", "GreedyTL", 10, 77.81146, 0)) #0.15789754
accuracy<-rbind(accuracy,c("Office", "GreedyTL", 25, 77.99, 0))
accuracy<-rbind(accuracy,c("Office", "GreedyTL", 50, 78.31146, 0))
accuracy<-rbind(accuracy,c("Office", "GreedyTL", 100, 78.31, 0))
accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 10, 84.93901963, 0))
accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 25, 85.00039066, 0))
accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 50, 85.33356154, 0))
accuracy<-rbind(accuracy,c("Office", "AccGenSVM", 100, 85.66205464, 0))
#Caltech256
accuracy<-rbind(accuracy,c("Caltech256","TH", 10, 89.8763, 0))
accuracy<-rbind(accuracy,c("Caltech256", "TH", 25, 90.2570, 0))
accuracy<-rbind(accuracy,c("Caltech256", "TH", 50, 90.9575, 0))
accuracy<-rbind(accuracy,c("Caltech256", "TH", 100, 89.8809, 0))
accuracy<-rbind(accuracy,c("Caltech256","SH", 10, 72.0859, 0))
accuracy<-rbind(accuracy,c("Caltech256", "SH", 25, 72.0859, 0))
accuracy<-rbind(accuracy,c("Caltech256", "SH", 50, 74.0846, 0))
accuracy<-rbind(accuracy,c("Caltech256", "SH", 100, 73.0846, 0))
accuracy<-rbind(accuracy,c("Caltech256", "S+TH", 10, 79.8763, 0))
accuracy<-rbind(accuracy,c("Caltech256", "S+TH", 25, 80.2570, 0))
accuracy<-rbind(accuracy,c("Caltech256", "S+TH", 50, 80.9575, 0))
accuracy<-rbind(accuracy,c("Caltech256", "S+TH", 100, 79.8809, 0))
accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 10, 91.0081, 0))
accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 25, 91.1330, 0))
accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 50, 91.5245, 0))
accuracy<-rbind(accuracy,c("Caltech256", "ASVM", 100, 90.9885, 0))
accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 10, 88.94, 0))
accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 25, 89.64, 0))
accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 50, 89.59, 0))
accuracy<-rbind(accuracy,c("Caltech256", "GreedyTL", 100, 89.64, 0))
accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 10, 91.3232, 0))
accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 25, 91.7209, 0))
accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 50, 92.5843, 0))
accuracy<-rbind(accuracy,c("Caltech256", "AccGenSVM", 100, 93.1105, 0))
# #ImageNet
accuracy<-rbind(accuracy,c("ImageNet","TH", 10, 79.2553, 0))
accuracy<-rbind(accuracy,c("ImageNet", "TH", 25, 79.2553, 0))
accuracy<-rbind(accuracy,c("ImageNet", "TH", 50, 79.2553, 0))
accuracy<-rbind(accuracy,c("ImageNet", "TH", 100, 79.2553, 0))
accuracy<-rbind(accuracy,c("ImageNet","SH", 10, 72.0593, 0))
accuracy<-rbind(accuracy,c("ImageNet", "SH", 25, 72.56786, 0))
accuracy<-rbind(accuracy,c("ImageNet", "SH", 50, 72.0593, 0))
accuracy<-rbind(accuracy,c("ImageNet", "SH", 100, 72.56786, 0))
accuracy<-rbind(accuracy,c("ImageNet", "S+TH", 10, 76.2553, 0))
accuracy<-rbind(accuracy,c("ImageNet", "S+TH", 25, 76.2553, 0))
accuracy<-rbind(accuracy,c("ImageNet", "S+TH", 50, 77.0553, 0))
accuracy<-rbind(accuracy,c("ImageNet", "S+TH", 100, 76.2553, 0))
accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 10, 80.6827, 0))
accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 25, 80.6027, 0))
accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 50, 80.4526, 0))
accuracy<-rbind(accuracy,c("ImageNet", "ASVM", 100, 80.6827, 0))
accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 10, 0, 0))
accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 25, 0, 0))
accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 50, 0, 0))
accuracy<-rbind(accuracy,c("ImageNet", "GreedyTL", 100, 0, 0))
accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 10, 82.4445, 0))
accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 25, 82.8409, 0))
accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 50, 83.6369, 0))
accuracy<-rbind(accuracy,c("ImageNet", "AccGenSVM", 100, 83.9369, 0))
rownames(accuracy)<-NULL
accuracy<-as.data.frame(accuracy)
colnames(accuracy)<-c("dataset", "method", "sources", "accur", "stdev")
accuracy$accur<-as.double(as.character(accuracy$accur))
accuracy$stdev<-as.double(as.character(accuracy$stdev))
accuracy$sources <- factor(accuracy$sources, levels = c("10", "25", "50", "100"))
accuracy$dataset <- factor(accuracy$dataset, levels = c("Office", "Caltech256", "ImageNet"))

plotAccuracy <- ggplot(accuracy, aes(x = sources, y = accur, group = method, shape = method, colour = method )) +
  geom_line() + geom_point() + facet_grid(. ~ dataset) + xlab("number of sources (%)") + ylab("prediction accuracy (%)") + theme(legend.title=element_blank()) +
  panel_border() + theme(text=element_text(family="serif"), legend.text = element_text(size=16), strip.text.x = element_text(size = 20), legend.justification=c(1,0), legend.position=c(1,0), legend.background = element_rect(color = "black", size = 0.8, linetype = "solid"), panel.border = element_rect(colour = "black", fill=NA, size=1), axis.text=element_text(size=18), axis.title=element_text(size=18)) + ylim(60, 100)
plotAccuracy <- plotAccuracy
plotAccuracy

# #Convergence rate
# convergence<-data.frame(dataset = character(), method = character(), numbersources = integer(), convergence = double())
# #Caltech256
# convergence<-c("Caltech256","NT0", 10, 55.0463)
# convergence<-rbind(convergence,c("Caltech256", "NT0", 25, 55.1139))
# convergence<-rbind(convergence,c("Caltech256", "NT0", 50, 55.1139))
# convergence<-rbind(convergence,c("Caltech256", "NT0", 100,54.8477))
# convergence<-rbind(convergence,c("Caltech256", "ASVM", 10, 286.3181))
# convergence<-rbind(convergence,c("Caltech256", "ASVM", 25, 284.4559))
# convergence<-rbind(convergence,c("Caltech256", "ASVM", 50, 259.3333))
# convergence<-rbind(convergence,c("Caltech256", "ASVM", 100, 265.3651))
# convergence<-rbind(convergence,c("Caltech256", "AccGenSVM", 10, 24.2222))
# convergence<-rbind(convergence,c("Caltech256", "AccGenSVM", 25, 21.5555))
# convergence<-rbind(convergence,c("Caltech256", "AccGenSVM", 50, 21.4125))
# convergence<-rbind(convergence,c("Caltech256", "AccGenSVM", 100, 20.3721))
# #ImageNet
# convergence<-rbind(convergence,c("ImageNet","NT0", 10, 228.0417))
# convergence<-rbind(convergence,c("ImageNet", "NT0", 25, 229.4717))
# convergence<-rbind(convergence,c("ImageNet", "NT0", 50, 228.0417))
# convergence<-rbind(convergence,c("ImageNet", "NT0", 100, 229.4717))
# convergence<-rbind(convergence,c("ImageNet", "ASVM", 10, 1210))
# convergence<-rbind(convergence,c("ImageNet", "ASVM", 25, 1179.4))
# convergence<-rbind(convergence,c("ImageNet", "ASVM", 50, 1139.0112))
# convergence<-rbind(convergence,c("ImageNet", "ASVM", 100, 1210))
# convergence<-rbind(convergence,c("ImageNet", "AccGenSVM", 10, 165.1428))
# convergence<-rbind(convergence,c("ImageNet", "AccGenSVM", 25, 168.7736))
# convergence<-rbind(convergence,c("ImageNet", "AccGenSVM", 50, 168.7736))
# convergence<-rbind(convergence,c("ImageNet", "AccGenSVM", 100, 171.0949))
# #Office
# convergence<-rbind(convergence,c("Office","NT0", 10, 38.7595))
# convergence<-rbind(convergence,c("Office", "NT0", 25, 39.0695))
# convergence<-rbind(convergence,c("Office", "NT0", 50, 38.7595))
# convergence<-rbind(convergence,c("Office", "NT0", 100, 40.0436))
# convergence<-rbind(convergence,c("Office", "ASVM", 10, 118.0678))
# convergence<-rbind(convergence,c("Office", "ASVM", 25, 118.0678))
# convergence<-rbind(convergence,c("Office", "ASVM", 50, 118.0678))
# convergence<-rbind(convergence,c("Office", "ASVM", 100, 121.0678))
# convergence<-rbind(convergence,c("Office", "AccGenSVM", 10, 24.37404))
# convergence<-rbind(convergence,c("Office", "AccGenSVM", 25, 25.07404))
# convergence<-rbind(convergence,c("Office", "AccGenSVM", 50, 23.99404))
# convergence<-rbind(convergence,c("Office", "AccGenSVM", 100, 24.37404))
# rownames(convergence)<-NULL
# convergence<-as.data.frame(convergence)
# colnames(convergence)<-c("dataset", "method", "sources", "conv")
# convergence$conv<-as.double(as.character(convergence$conv))
# convergence$sources <- factor(convergence$sources, levels = c("10", "25", "50", "100"))
# 
# plotConvergence <- ggplot(convergence, aes(x = sources, y = conv, group = method, shape = method, colour = method )) + 
#   geom_line() + geom_point() + facet_grid(. ~ dataset) + xlab("number of sources (%)") + ylab("convergence rate (#)") + theme(legend.title=element_blank()) + 
#   panel_border() + theme(text=element_text(family="serif"))
# plotConvergence <- plotConvergence + scale_colour_grey()
# plotConvergence

#Convergence rate
convergence<-data.frame(dataset = character(), method = character(), numbersources = integer(), convergence = double(), stdev = double())
#Caltech256
convergence<-c("Caltech256","NT0", 10, 55.0463, 9.9375)
convergence<-rbind(convergence,c("Caltech256", "NT0", 25, 55.1139, 10.7414))
convergence<-rbind(convergence,c("Caltech256", "NT0", 50, 55.1139, 10.7414))
convergence<-rbind(convergence,c("Caltech256", "NT0", 100,54.8477,10.9315))
convergence<-rbind(convergence,c("Caltech256", "ASVM", 10, 286.3181, 138.5711))
convergence<-rbind(convergence,c("Caltech256", "ASVM", 25, 284.4559, 134.4448))
convergence<-rbind(convergence,c("Caltech256", "ASVM", 50, 259.3333, 131.3009))
convergence<-rbind(convergence,c("Caltech256", "ASVM", 100, 265.3651, 140.3338))
convergence<-rbind(convergence,c("Caltech256", "AccGenSVM", 10, 24.2222, 8.6747))
convergence<-rbind(convergence,c("Caltech256", "AccGenSVM", 25, 21.5555, 9.0967))
convergence<-rbind(convergence,c("Caltech256", "AccGenSVM", 50, 21.4125, 8.0103))
convergence<-rbind(convergence,c("Caltech256", "AccGenSVM", 100, 20.3721, 8.4159))
#ImageNet
convergence<-rbind(convergence,c("ImageNet","NT0", 10, 228.0417, 46.1977))
convergence<-rbind(convergence,c("ImageNet", "NT0", 25, 230.4717, 42.1873))
convergence<-rbind(convergence,c("ImageNet", "NT0", 50, 228.0417, 48.4589))
convergence<-rbind(convergence,c("ImageNet", "NT0", 100, 229.4717, 47.1873))
convergence<-rbind(convergence,c("ImageNet", "ASVM", 10, 1210, 258.4626))
convergence<-rbind(convergence,c("ImageNet", "ASVM", 25, 1179.4, 242.3842))
convergence<-rbind(convergence,c("ImageNet", "ASVM", 50, 1139.0112, 233.1890))
convergence<-rbind(convergence,c("ImageNet", "ASVM", 100, 1210, 233.1890))
convergence<-rbind(convergence,c("ImageNet", "AccGenSVM", 10, 165.1428, 30.5283))
convergence<-rbind(convergence,c("ImageNet", "AccGenSVM", 25, 168.7736, 27.8372))
convergence<-rbind(convergence,c("ImageNet", "AccGenSVM", 50, 168.7736, 28.2351))
convergence<-rbind(convergence,c("ImageNet", "AccGenSVM", 100, 171.0949, 28.2351))
#Office
convergence<-rbind(convergence,c("Office","NT0", 10, 38.7595, 7.40))
convergence<-rbind(convergence,c("Office", "NT0", 25, 39.0695, 7.87))
convergence<-rbind(convergence,c("Office", "NT0", 50, 38.7595, 7.66))
convergence<-rbind(convergence,c("Office", "NT0", 100, 40.0436, 7.44))
convergence<-rbind(convergence,c("Office", "ASVM", 10, 118.0678, 9.997))
convergence<-rbind(convergence,c("Office", "ASVM", 25, 118.0678, 9.997))
convergence<-rbind(convergence,c("Office", "ASVM", 50, 118.0678, 9.997))
convergence<-rbind(convergence,c("Office", "ASVM", 100, 121.0678, 9.997))
convergence<-rbind(convergence,c("Office", "AccGenSVM", 10, 24.37404, 9.58))
convergence<-rbind(convergence,c("Office", "AccGenSVM", 25, 24.07404, 9.58))
convergence<-rbind(convergence,c("Office", "AccGenSVM", 50, 23.99404, 9.58))
convergence<-rbind(convergence,c("Office", "AccGenSVM", 100, 24.37404, 9.58))
rownames(convergence)<-NULL
convergence<-as.data.frame(convergence)
colnames(convergence)<-c("dataset", "method", "sources", "conv", "stdev")
convergence$conv<-as.double(as.character(convergence$conv))
convergence$stdev<-as.double(as.character(convergence$stdev))
convergence$sources <- factor(convergence$sources, levels = c("10", "25", "50", "100"))

plotConvergence <- ggplot(convergence, aes(x = sources, y = conv, group = method, shape = method, colour = method )) +
  geom_line() + geom_point() + facet_grid(. ~ dataset) + xlab("number of sources (%)") + ylab("convergence rate (#)") + theme(legend.title=element_blank()) +
  panel_border() + theme(text=element_text(family="serif", size = 20), legend.text = element_text(face="bold", size=12), strip.text.x = element_text(face="bold")) + geom_errorbar(aes(x=sources, ymin=conv-stdev, ymax=conv+stdev), width=0.25)
plotConvergence <- plotConvergence + scale_colour_grey()
plotConvergence

#Stability for concept drift
drift<-data.frame(method = character(), numbersources = integer(), convergence = double())
#Caltech256
drift<-c("TH", 0, 89.40426)
drift<-rbind(drift,c("TH", 10, 89.47863))
drift<-rbind(drift,c("TH", 20, 89.59151))
drift<-rbind(drift,c("TH", 30, 89.86055))
drift<-rbind(drift,c("TH", 40, 89.94804))
drift<-rbind(drift,c("TH", 50, 89.77282))
drift<-rbind(drift,c("TH", 60, 90.24232))
drift<-rbind(drift,c("TH", 70, 90.30493))
drift<-rbind(drift,c("TH", 80, 90.04816))
drift<-rbind(drift,c("TH", 90, 89.80392))
drift<-rbind(drift,c("TH", 100, 90.19845))
drift<-rbind(drift,c("ASVM", 0, 89.71465))
drift<-rbind(drift,c("ASVM", 10, 89.08887))
drift<-rbind(drift,c("ASVM", 20, 89.33918))
drift<-rbind(drift,c("ASVM", 30, 89.23905))
drift<-rbind(drift,c("ASVM", 40, 89.35169))
drift<-rbind(drift,c("ASVM", 50, 89.36334))
drift<-rbind(drift,c("ASVM", 60, 89.05157))
drift<-rbind(drift,c("ASVM", 70, 89.0149))
drift<-rbind(drift,c("ASVM", 80, 88.30038))
drift<-rbind(drift,c("ASVM", 90, 88.02504))
drift<-rbind(drift,c("ASVM", 100, 87.91238))
drift<-rbind(drift,c("AccGenSVM", 0, 93.55944))
drift<-rbind(drift,c("AccGenSVM", 10, 91.88237))
drift<-rbind(drift,c("AccGenSVM", 20, 90.33042))
drift<-rbind(drift,c("AccGenSVM", 30, 90.54317))
drift<-rbind(drift,c("AccGenSVM", 40, 89.56669))
drift<-rbind(drift,c("AccGenSVM", 50, 89.6671))
drift<-rbind(drift,c("AccGenSVM", 60, 90.0175))
drift<-rbind(drift,c("AccGenSVM", 70, 90.30493))
drift<-rbind(drift,c("AccGenSVM", 80, 90.04816))
drift<-rbind(drift,c("AccGenSVM", 90, 89.9914))
drift<-rbind(drift,c("AccGenSVM", 100, 90.1984))
drift<-rbind(drift,c("GreedyTL", 0, 89.6400))
drift<-rbind(drift,c("GreedyTL", 10, 89.6456))
drift<-rbind(drift,c("GreedyTL", 20, 89.5004))
drift<-rbind(drift,c("GreedyTL", 30, 89.4004))
drift<-rbind(drift,c("GreedyTL", 40, 89.3004))
drift<-rbind(drift,c("GreedyTL", 50, 89.1004))
drift<-rbind(drift,c("GreedyTL", 60, 89.0104))
drift<-rbind(drift,c("GreedyTL", 70, 88.9904))
drift<-rbind(drift,c("GreedyTL", 80, 88.6204))
drift<-rbind(drift,c("GreedyTL", 90, 88.5604))
drift<-rbind(drift,c("GreedyTL", 100, 88.4004))
rownames(drift)<-NULL
drift<-as.data.frame(drift)
colnames(drift)<-c("method", "level", "drift")
drift$drift<-as.double(as.character(drift$drift))
drift$level <- factor(drift$level, levels = c("0", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100"))

plotDrift <- ggplot(drift, aes(x = level, y = drift, group = method, shape = method, colour = method )) + 
  geom_line() + geom_point() + xlab("drift level (%)") + ylab("prediction accuracy (%)") + theme(legend.title=element_blank()) + 
  panel_border() + theme(text=element_text(family="serif", size = 24), legend.text = element_text(size=18), strip.text.x = element_text(size = 20), legend.justification=c(1,0), legend.position=c(1,0), legend.background = element_rect(color = "black", size = 0.8, linetype = "solid"), panel.border = element_rect(colour = "black", fill=NA, size=1), axis.text=element_text(size=18), axis.title=element_text(size=18)) + ylim(80, 100)
plotDrift <- plotDrift
plotDrift <- plotDrift + annotate(geom="text", x = 8, y = 91, label = c("X"))
plotDrift